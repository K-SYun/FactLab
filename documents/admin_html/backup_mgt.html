<!-- 백업 관리 페이지 -->
<main class="p-6 ml-64">
    <!-- 페이지 헤더 -->
    <div class="mb-8">
        <h1 class="text-2xl font-bold text-gray-900">백업 관리</h1>
        <p class="text-gray-600 mt-2">데이터베이스 및 파일 백업 관리 시스템</p>
    </div>

    <!-- 백업 상태 개요 -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="stat-card blue rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-white/80 text-sm">마지막 백업</p>
                    <p class="text-2xl font-bold" id="lastBackup">2시간 전</p>
                    <p class="text-white/80 text-xs mt-1">
                        <i class="fas fa-check mr-1"></i>
                        성공적으로 완료
                    </p>
                </div>
                <div class="bg-white/20 p-3 rounded-full">
                    <i class="fas fa-database text-2xl"></i>
                </div>
            </div>
        </div>

        <div class="stat-card green rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-white/80 text-sm">백업 성공률</p>
                    <p class="text-2xl font-bold" id="successRate">99.8%</p>
                    <p class="text-white/80 text-xs mt-1">
                        <i class="fas fa-chart-line mr-1"></i>
                        지난 30일
                    </p>
                </div>
                <div class="bg-white/20 p-3 rounded-full">
                    <i class="fas fa-check-circle text-2xl"></i>
                </div>
            </div>
        </div>

        <div class="stat-card orange rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-white/80 text-sm">저장소 사용량</p>
                    <p class="text-2xl font-bold" id="storageUsed">847GB</p>
                    <p class="text-white/80 text-xs mt-1">
                        <i class="fas fa-hdd mr-1"></i>
                        2TB 중 42%
                    </p>
                </div>
                <div class="bg-white/20 p-3 rounded-full">
                    <i class="fas fa-server text-2xl"></i>
                </div>
            </div>
        </div>

        <div class="stat-card purple rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-white/80 text-sm">복원 지점</p>
                    <p class="text-2xl font-bold" id="restorePoints">168</p>
                    <p class="text-white/80 text-xs mt-1">
                        <i class="fas fa-history mr-1"></i>
                        사용 가능한 복원 지점
                    </p>
                </div>
                <div class="bg-white/20 p-3 rounded-full">
                    <i class="fas fa-undo text-2xl"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- 백업 작업 및 스케줄 -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <!-- 즉시 백업 실행 -->
        <div class="bg-white rounded-lg shadow-sm p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">즉시 백업 실행</h3>
            <div class="space-y-4">
                <div>
                    <label class="form-label">백업 대상</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" checked> 사용자 데이터베이스
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" checked> 뉴스 데이터베이스
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2" checked> 게시판 데이터
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2"> 시스템 설정
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2"> 업로드 파일
                        </label>
                    </div>
                </div>
                
                <div>
                    <label class="form-label">백업 유형</label>
                    <select class="form-select" id="backupType">
                        <option value="full">전체 백업</option>
                        <option value="incremental">증분 백업</option>
                        <option value="differential">차등 백업</option>
                    </select>
                </div>
                
                <div>
                    <label class="form-label">압축 옵션</label>
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">백업 파일 압축 (권장)</span>
                        <button class="bg-green-500 relative inline-flex h-6 w-11 items-center rounded-full">
                            <span class="translate-x-6 inline-block h-4 w-4 transform rounded-full bg-white transition"></span>
                        </button>
                    </div>
                </div>
                
                <div class="border-t pt-4">
                    <button class="btn-primary w-full" onclick="startBackup()">
                        <i class="fas fa-play mr-2"></i>백업 시작
                    </button>
                </div>
            </div>
        </div>

        <!-- 백업 스케줄 -->
        <div class="bg-white rounded-lg shadow-sm p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">자동 백업 스케줄</h3>
            <div class="space-y-4">
                <div class="p-4 bg-green-50 rounded-lg">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium text-green-900">일일 전체 백업</h4>
                        <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">활성</span>
                    </div>
                    <p class="text-sm text-green-700">매일 오전 2:00 실행</p>
                    <p class="text-sm text-green-600">다음 실행: 오늘 오전 2:00</p>
                    <div class="flex justify-between items-center mt-2">
                        <span class="text-xs text-green-600">마지막 실행: 어제 오전 2:00 (성공)</span>
                        <button class="text-xs text-green-600 hover:text-green-800" onclick="editSchedule('daily')">수정</button>
                    </div>
                </div>
                
                <div class="p-4 bg-blue-50 rounded-lg">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium text-blue-900">시간별 증분 백업</h4>
                        <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">활성</span>
                    </div>
                    <p class="text-sm text-blue-700">매시간 0분 실행</p>
                    <p class="text-sm text-blue-600">다음 실행: 15:00</p>
                    <div class="flex justify-between items-center mt-2">
                        <span class="text-xs text-blue-600">마지막 실행: 14:00 (성공)</span>
                        <button class="text-xs text-blue-600 hover:text-blue-800" onclick="editSchedule('hourly')">수정</button>
                    </div>
                </div>
                
                <div class="p-4 bg-yellow-50 rounded-lg">
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-medium text-yellow-900">주간 아카이브</h4>
                        <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">활성</span>
                    </div>
                    <p class="text-sm text-yellow-700">매주 일요일 오전 1:00 실행</p>
                    <p class="text-sm text-yellow-600">다음 실행: 1월 21일 오전 1:00</p>
                    <div class="flex justify-between items-center mt-2">
                        <span class="text-xs text-yellow-600">마지막 실행: 1월 14일 (성공)</span>
                        <button class="text-xs text-yellow-600 hover:text-yellow-800" onclick="editSchedule('weekly')">수정</button>
                    </div>
                </div>
                
                <button class="btn-secondary w-full" onclick="addNewSchedule()">
                    <i class="fas fa-plus mr-2"></i>새 스케줄 추가
                </button>
            </div>
        </div>
    </div>

    <!-- 백업 히스토리 -->
    <div class="bg-white rounded-lg shadow-sm mb-8">
        <div class="px-6 py-4 border-b border-gray-200">
            <div class="flex items-center justify-between">
                <h3 class="text-lg font-semibold text-gray-800">백업 히스토리</h3>
                <div class="flex items-center space-x-3">
                    <select class="form-select text-sm">
                        <option value="7">최근 7일</option>
                        <option value="30" selected>최근 30일</option>
                        <option value="90">최근 90일</option>
                    </select>
                    <button class="btn-secondary text-sm" onclick="refreshBackupHistory()">
                        <i class="fas fa-sync mr-2"></i>새로고침
                    </button>
                </div>
            </div>
        </div>
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">백업 시간</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">유형</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">대상</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">크기</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">소요 시간</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">상태</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">액션</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <tr class="table-row">
                        <td class="px-6 py-4 text-sm text-gray-900">2024-01-15 02:00:00</td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">전체</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900">모든 데이터베이스</td>
                        <td class="px-6 py-4 text-sm text-gray-900">12.4GB</td>
                        <td class="px-6 py-4 text-sm text-gray-900">18분 32초</td>
                        <td class="px-6 py-4">
                            <span class="status-badge completed">성공</span>
                        </td>
                        <td class="px-6 py-4 text-sm font-medium">
                            <button class="text-green-600 hover:text-green-900 mr-3" onclick="restoreBackup('backup-20240115-0200')">복원</button>
                            <button class="text-indigo-600 hover:text-indigo-900 mr-3" onclick="downloadBackup('backup-20240115-0200')">다운로드</button>
                            <button class="text-red-600 hover:text-red-900" onclick="deleteBackup('backup-20240115-0200')">삭제</button>
                        </td>
                    </tr>
                    <tr class="table-row">
                        <td class="px-6 py-4 text-sm text-gray-900">2024-01-15 14:00:00</td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">증분</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900">사용자, 뉴스 DB</td>
                        <td class="px-6 py-4 text-sm text-gray-900">890MB</td>
                        <td class="px-6 py-4 text-sm text-gray-900">3분 45초</td>
                        <td class="px-6 py-4">
                            <span class="status-badge completed">성공</span>
                        </td>
                        <td class="px-6 py-4 text-sm font-medium">
                            <button class="text-green-600 hover:text-green-900 mr-3" onclick="restoreBackup('backup-20240115-1400')">복원</button>
                            <button class="text-indigo-600 hover:text-indigo-900 mr-3" onclick="downloadBackup('backup-20240115-1400')">다운로드</button>
                            <button class="text-red-600 hover:text-red-900" onclick="deleteBackup('backup-20240115-1400')">삭제</button>
                        </td>
                    </tr>
                    <tr class="table-row">
                        <td class="px-6 py-4 text-sm text-gray-900">2024-01-15 13:00:00</td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">증분</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900">사용자, 뉴스 DB</td>
                        <td class="px-6 py-4 text-sm text-gray-900">756MB</td>
                        <td class="px-6 py-4 text-sm text-gray-900">2분 58초</td>
                        <td class="px-6 py-4">
                            <span class="status-badge completed">성공</span>
                        </td>
                        <td class="px-6 py-4 text-sm font-medium">
                            <button class="text-green-600 hover:text-green-900 mr-3" onclick="restoreBackup('backup-20240115-1300')">복원</button>
                            <button class="text-indigo-600 hover:text-indigo-900 mr-3" onclick="downloadBackup('backup-20240115-1300')">다운로드</button>
                            <button class="text-red-600 hover:text-red-900" onclick="deleteBackup('backup-20240115-1300')">삭제</button>
                        </td>
                    </tr>
                    <tr class="table-row">
                        <td class="px-6 py-4 text-sm text-gray-500">2024-01-15 12:00:00</td>
                        <td class="px-6 py-4">
                            <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">증분</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-500">사용자, 뉴스 DB</td>
                        <td class="px-6 py-4 text-sm text-gray-500">-</td>
                        <td class="px-6 py-4 text-sm text-gray-500">타임아웃</td>
                        <td class="px-6 py-4">
                            <span class="status-badge false">실패</span>
                        </td>
                        <td class="px-6 py-4 text-sm font-medium">
                            <button class="text-yellow-600 hover:text-yellow-900 mr-3" onclick="retryBackup('backup-20240115-1200')">재시도</button>
                            <button class="text-indigo-600 hover:text-indigo-900" onclick="viewBackupLog('backup-20240115-1200')">로그</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 복원 및 스토리지 관리 -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- 시스템 복원 -->
        <div class="bg-white rounded-lg shadow-sm p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">시스템 복원</h3>
            <div class="space-y-4">
                <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                    <div class="flex items-start">
                        <i class="fas fa-exclamation-triangle text-yellow-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-yellow-800">주의사항</h4>
                            <p class="text-sm text-yellow-700 mt-1">
                                시스템 복원은 현재 데이터를 백업 시점의 상태로 되돌립니다. 
                                복원 후에는 백업 이후의 모든 변경사항이 손실됩니다.
                            </p>
                        </div>
                    </div>
                </div>
                
                <div>
                    <label class="form-label">복원 지점 선택</label>
                    <select class="form-select" id="restorePoint">
                        <option value="">복원 지점을 선택하세요</option>
                        <option value="backup-20240115-0200">2024-01-15 02:00 - 전체 백업 (12.4GB)</option>
                        <option value="backup-20240114-0200">2024-01-14 02:00 - 전체 백업 (12.1GB)</option>
                        <option value="backup-20240113-0200">2024-01-13 02:00 - 전체 백업 (11.9GB)</option>
                    </select>
                </div>
                
                <div>
                    <label class="form-label">복원 범위</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="restoreScope" value="full" class="mr-2" checked> 전체 시스템 복원
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="restoreScope" value="database" class="mr-2"> 데이터베이스만 복원
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="restoreScope" value="files" class="mr-2"> 파일만 복원
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="restoreScope" value="selective" class="mr-2"> 선택적 복원
                        </label>
                    </div>
                </div>
                
                <div class="border-t pt-4">
                    <button class="btn-danger w-full" onclick="startRestore()">
                        <i class="fas fa-undo mr-2"></i>시스템 복원 시작
                    </button>
                </div>
            </div>
        </div>

        <!-- 스토리지 관리 -->
        <div class="bg-white rounded-lg shadow-sm p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4">스토리지 관리</h3>
            <div class="space-y-4">
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-medium text-gray-800 mb-3">디스크 사용량</h4>
                    <div class="space-y-3">
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>전체 백업</span>
                                <span>487GB (57%)</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-500 h-2 rounded-full" style="width: 57%"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>증분 백업</span>
                                <span>234GB (28%)</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-green-500 h-2 rounded-full" style="width: 28%"></div>
                            </div>
                        </div>
                        
                        <div>
                            <div class="flex justify-between text-sm mb-1">
                                <span>아카이브</span>
                                <span>126GB (15%)</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-yellow-500 h-2 rounded-full" style="width: 15%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <label class="form-label">정리 옵션</label>
                    <div class="space-y-2">
                        <button class="btn-secondary w-full text-left" onclick="cleanupOldBackups()">
                            <i class="fas fa-trash mr-2"></i>30일 이상 된 백업 정리 (예상 절약: 156GB)
                        </button>
                        <button class="btn-secondary w-full text-left" onclick="compressBackups()">
                            <i class="fas fa-compress mr-2"></i>오래된 백업 압축 (예상 절약: 89GB)
                        </button>
                        <button class="btn-secondary w-full text-left" onclick="archiveOldBackups()">
                            <i class="fas fa-archive mr-2"></i>오래된 백업 아카이브로 이동 (예상 절약: 67GB)
                        </button>
                    </div>
                </div>
                
                <div class="border-t pt-4">
                    <h4 class="font-medium text-gray-800 mb-2">백업 보관 정책</h4>
                    <div class="text-sm text-gray-600 space-y-1">
                        <div class="flex justify-between">
                            <span>일일 백업 보관:</span>
                            <span>30일</span>
                        </div>
                        <div class="flex justify-between">
                            <span>주간 백업 보관:</span>
                            <span>12주</span>
                        </div>
                        <div class="flex justify-between">
                            <span>월간 백업 보관:</span>
                            <span>12개월</span>
                        </div>
                        <div class="flex justify-between">
                            <span>연간 백업 보관:</span>
                            <span>7년</span>
                        </div>
                    </div>
                    <button class="btn-secondary w-full mt-3" onclick="editRetentionPolicy()">
                        보관 정책 수정
                    </button>
                </div>
            </div>
        </div>
    </div>
</main>

<script>
// 백업 관리 관련 JavaScript 함수들
function startBackup() {
    const backupType = document.getElementById('backupType').value;
    
    if (confirm(`${getBackupTypeText(backupType)} 백업을 시작하시겠습니까?`)) {
        showNotification('백업을 시작합니다...', 'info');
        
        // 백업 진행 상황 시뮬레이션
        let progress = 0;
        const interval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress >= 100) {
                progress = 100;
                clearInterval(interval);
                showNotification('백업이 성공적으로 완료되었습니다.', 'success');
                refreshBackupHistory();
            } else {
                showNotification(`백업 진행 중... ${Math.floor(progress)}%`, 'info', 1000);
            }
        }, 1000);
    }
}

function startRestore() {
    const restorePoint = document.getElementById('restorePoint').value;
    const restoreScope = document.querySelector('input[name="restoreScope"]:checked').value;
    
    if (!restorePoint) {
        showNotification('복원 지점을 선택해주세요.', 'error');
        return;
    }
    
    const confirmMessage = `정말로 시스템을 복원하시겠습니까?\n\n복원 지점: ${restorePoint}\n복원 범위: ${getRestoreScopeText(restoreScope)}\n\n현재 데이터가 손실될 수 있습니다.`;
    
    if (confirm(confirmMessage)) {
        showNotification('시스템 복원을 시작합니다...', 'warning');
        
        // 복원 진행 상황 시뮬레이션
        let progress = 0;
        const interval = setInterval(() => {
            progress += Math.random() * 8;
            if (progress >= 100) {
                progress = 100;
                clearInterval(interval);
                showNotification('시스템 복원이 완료되었습니다. 페이지를 새로고침합니다.', 'success');
                setTimeout(() => {
                    window.location.reload();
                }, 3000);
            } else {
                showNotification(`복원 진행 중... ${Math.floor(progress)}%`, 'warning', 1000);
            }
        }, 2000);
    }
}

function restoreBackup(backupId) {
    if (confirm(`이 백업으로 시스템을 복원하시겠습니까?\n백업 ID: ${backupId}`)) {
        showNotification(`${backupId} 백업으로 복원을 시작합니다...`, 'info');
        
        setTimeout(() => {
            showNotification('백업 복원이 완료되었습니다.', 'success');
        }, 5000);
    }
}

function downloadBackup(backupId) {
    showNotification(`${backupId} 백업 파일을 준비하고 있습니다...`, 'info');
    
    setTimeout(() => {
        // 실제로는 백업 파일 다운로드 로직
        showNotification('백업 파일 다운로드가 시작되었습니다.', 'success');
    }, 3000);
}

function deleteBackup(backupId) {
    if (confirm(`정말로 이 백업을 삭제하시겠습니까?\n백업 ID: ${backupId}\n\n삭제된 백업은 복구할 수 없습니다.`)) {
        showNotification(`${backupId} 백업을 삭제하고 있습니다...`, 'warning');
        
        setTimeout(() => {
            showNotification('백업이 삭제되었습니다.', 'success');
            refreshBackupHistory();
        }, 2000);
    }
}

function retryBackup(backupId) {
    showNotification(`${backupId} 백업을 재시도합니다...`, 'info');
    
    setTimeout(() => {
        const success = Math.random() > 0.3; // 70% 성공률
        if (success) {
            showNotification('백업 재시도가 성공했습니다.', 'success');
        } else {
            showNotification('백업 재시도가 실패했습니다. 로그를 확인해주세요.', 'error');
        }
        refreshBackupHistory();
    }, 3000);
}

function viewBackupLog(backupId) {
    showModalDialog('백업 로그', getBackupLogContent(backupId));
}

function editSchedule(scheduleType) {
    const scheduleNames = {
        'daily': '일일 전체 백업',
        'hourly': '시간별 증분 백업',
        'weekly': '주간 아카이브'
    };
    
    showModalDialog(`${scheduleNames[scheduleType]} 수정`, getScheduleEditContent(scheduleType), function(formData) {
        showNotification(`${scheduleNames[scheduleType]} 스케줄이 수정되었습니다.`, 'success');
    });
}

function addNewSchedule() {
    showModalDialog('새 백업 스케줄 추가', getNewScheduleContent(), function(formData) {
        showNotification('새 백업 스케줄이 추가되었습니다.', 'success');
    });
}

function refreshBackupHistory() {
    showNotification('백업 히스토리를 새로고침합니다...', 'info');
    
    setTimeout(() => {
        showNotification('백업 히스토리가 업데이트되었습니다.', 'success');
        // 실제로는 테이블 데이터 새로고침
    }, 1500);
}

function cleanupOldBackups() {
    if (confirm('30일 이상 된 백업을 정리하시겠습니까?\n예상 절약 공간: 156GB')) {
        showNotification('오래된 백업을 정리하고 있습니다...', 'info');
        
        setTimeout(() => {
            showNotification('오래된 백업 정리가 완료되었습니다. 156GB의 공간이 확보되었습니다.', 'success');
            updateStorageStats();
        }, 8000);
    }
}

function compressBackups() {
    if (confirm('오래된 백업을 압축하시겠습니까?\n예상 절약 공간: 89GB\n압축된 백업은 복원 시 더 오래 걸릴 수 있습니다.')) {
        showNotification('백업 파일을 압축하고 있습니다...', 'info');
        
        setTimeout(() => {
            showNotification('백업 압축이 완료되었습니다. 89GB의 공간이 확보되었습니다.', 'success');
            updateStorageStats();
        }, 12000);
    }
}

function archiveOldBackups() {
    if (confirm('오래된 백업을 아카이브로 이동하시겠습니까?\n예상 절약 공간: 67GB')) {
        showNotification('백업을 아카이브로 이동하고 있습니다...', 'info');
        
        setTimeout(() => {
            showNotification('백업 아카이브 이동이 완료되었습니다. 67GB의 공간이 확보되었습니다.', 'success');
            updateStorageStats();
        }, 6000);
    }
}

function editRetentionPolicy() {
    showModalDialog('백업 보관 정책 수정', getRetentionPolicyContent(), function(formData) {
        showNotification('백업 보관 정책이 수정되었습니다.', 'success');
    });
}

function updateStorageStats() {
    const storageUsed = document.getElementById('storageUsed');
    if (storageUsed) {
        const current = parseInt(storageUsed.textContent.replace('GB', ''));
        const newUsage = Math.max(current - Math.floor(Math.random() * 100), 400);
        storageUsed.textContent = newUsage + 'GB';
    }
}

// 헬퍼 함수들
function getBackupTypeText(type) {
    const types = {
        'full': '전체',
        'incremental': '증분',
        'differential': '차등'
    };
    return types[type] || type;
}

function getRestoreScopeText(scope) {
    const scopes = {
        'full': '전체 시스템',
        'database': '데이터베이스만',
        'files': '파일만',
        'selective': '선택적'
    };
    return scopes[scope] || scope;
}

function getBackupLogContent(backupId) {
    return `
        <div class="space-y-4">
            <div class="bg-gray-900 text-green-400 font-mono text-sm p-4 rounded-lg h-64 overflow-y-auto">
                <div class="space-y-1">
                    <div>[2024-01-15 12:00:00] 백업 작업 시작: ${backupId}</div>
                    <div>[2024-01-15 12:00:01] 데이터베이스 연결 확인...</div>
                    <div>[2024-01-15 12:00:02] 사용자 데이터베이스 백업 시작</div>
                    <div>[2024-01-15 12:00:05] 뉴스 데이터베이스 백업 시작</div>
                    <div>[2024-01-15 12:05:23] <span class="text-red-400">오류: 데이터베이스 연결 타임아웃</span></div>
                    <div>[2024-01-15 12:05:24] 재연결 시도 중...</div>
                    <div>[2024-01-15 12:05:30] <span class="text-red-400">오류: 최대 재시도 횟수 초과</span></div>
                    <div>[2024-01-15 12:05:31] 백업 작업 중단</div>
                    <div>[2024-01-15 12:05:32] 임시 파일 정리 완료</div>
                    <div>[2024-01-15 12:05:33] <span class="text-red-400">백업 실패: 데이터베이스 연결 오류</span></div>
                </div>
            </div>
            <div class="text-sm text-gray-600">
                <strong>오류 요약:</strong> 데이터베이스 서버와의 연결이 불안정하여 백업이 실패했습니다. 
                네트워크 상태를 확인하고 재시도해주세요.
            </div>
        </div>
    `;
}

function getScheduleEditContent(scheduleType) {
    return `
        <div class="space-y-4">
            <div>
                <label class="form-label">실행 시간</label>
                <input type="time" class="form-input" value="02:00">
            </div>
            <div>
                <label class="form-label">백업 유형</label>
                <select class="form-select">
                    <option value="full">전체 백업</option>
                    <option value="incremental">증분 백업</option>
                    <option value="differential">차등 백업</option>
                </select>
            </div>
            <div>
                <label class="form-label">백업 대상</label>
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" checked> 사용자 데이터베이스
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2" checked> 뉴스 데이터베이스
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="mr-2"> 시스템 설정
                    </label>
                </div>
            </div>
            <div>
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2" checked>
                    <span>스케줄 활성화</span>
                </label>
            </div>
        </div>
    `;
}

function getNewScheduleContent() {
    return `
        <div class="space-y-4">
            <div>
                <label class="form-label">스케줄 이름</label>
                <input type="text" class="form-input" placeholder="예: 월간 전체 백업">
            </div>
            <div>
                <label class="form-label">실행 주기</label>
                <select class="form-select">
                    <option value="hourly">매시간</option>
                    <option value="daily">매일</option>
                    <option value="weekly">매주</option>
                    <option value="monthly">매월</option>
                </select>
            </div>
            <div>
                <label class="form-label">실행 시간</label>
                <input type="time" class="form-input" value="03:00">
            </div>
            <div>
                <label class="form-label">백업 유형</label>
                <select class="form-select">
                    <option value="full">전체 백업</option>
                    <option value="incremental">증분 백업</option>
                    <option value="differential">차등 백업</option>
                </select>
            </div>
        </div>
    `;
}

function getRetentionPolicyContent() {
    return `
        <div class="space-y-4">
            <div>
                <label class="form-label">일일 백업 보관 기간</label>
                <select class="form-select">
                    <option value="7">7일</option>
                    <option value="30" selected>30일</option>
                    <option value="60">60일</option>
                    <option value="90">90일</option>
                </select>
            </div>
            <div>
                <label class="form-label">주간 백업 보관 기간</label>
                <select class="form-select">
                    <option value="4">4주</option>
                    <option value="8">8주</option>
                    <option value="12" selected>12주</option>
                    <option value="24">24주</option>
                </select>
            </div>
            <div>
                <label class="form-label">월간 백업 보관 기간</label>
                <select class="form-select">
                    <option value="6">6개월</option>
                    <option value="12" selected>12개월</option>
                    <option value="24">24개월</option>
                    <option value="36">36개월</option>
                </select>
            </div>
            <div>
                <label class="form-label">연간 백업 보관 기간</label>
                <select class="form-select">
                    <option value="3">3년</option>
                    <option value="5">5년</option>
                    <option value="7" selected>7년</option>
                    <option value="10">10년</option>
                </select>
            </div>
            <div>
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2" checked>
                    <span>자동 정리 활성화</span>
                </label>
            </div>
        </div>
    `;
}

// 페이지 로드 시 초기화
document.addEventListener('DOMContentLoaded', function() {
    // 5분마다 백업 상태 업데이트
    setInterval(() => {
        const lastBackup = document.getElementById('lastBackup');
        if (lastBackup) {
            // 마지막 백업 시간 업데이트 로직
        }
    }, 300000);
});
</script>