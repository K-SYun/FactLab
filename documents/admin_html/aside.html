<!-- FactLab 관리자 사이드바 (수정됨) -->
<div id="sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg sidebar-transition">
    <!-- 로고 및 브랜딩 -->
    <div class="flex items-center justify-center h-16 bg-indigo-600">
        <h1 class="text-xl font-bold text-white">
            <i class="fas fa-flask mr-2"></i>
            FactLab Admin
        </h1>
    </div>
    
    <!-- 메인 네비게이션 -->
    <nav class="mt-8">
        <div class="px-4 space-y-2">
            <!-- 대시보드 (유지) -->
            <a href="index.html" class="nav-link --set-active-index-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                <i class="fas fa-tachometer-alt mr-3 text-indigo-500"></i>
                <span>대시보드</span>
            </a>
            
            <!-- 사용자 관리 (유지) -->
            <a href="users.html" class="nav-link --set-active-users-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                <i class="fas fa-users mr-3 text-blue-500"></i>
                <span>사용자 관리</span>
            </a>
            
            <!-- 뉴스 수집 관리 (신규) -->
            <a href="news-collection.html" class="nav-link --set-active-news-collection-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                <i class="fas fa-newspaper mr-3 text-green-500"></i>
                <span>뉴스 수집 관리</span>
                <span class="ml-auto px-2 py-1 text-xs bg-green-100 text-green-600 rounded-full" id="newsCollectedToday">+142</span>
            </a>
            
            <!-- 게시판 관리 (신규) -->
            <a href="board-management.html" class="nav-link --set-active-board-management-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                <i class="fas fa-layer-group mr-3 text-purple-500"></i>
                <span>게시판 관리</span>
                <span class="ml-auto px-2 py-1 text-xs bg-purple-100 text-purple-600 rounded-full" id="activeBoardCount">47</span>
            </a>
            
            <!-- AI 요약 관리 (신규) -->
            <a href="ai-summary.html" class="nav-link --set-active-ai-summary-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                <i class="fas fa-robot mr-3 text-orange-500"></i>
                <span>AI 요약 관리</span>
                <span class="ml-auto px-2 py-1 text-xs bg-orange-100 text-orange-600 rounded-full" id="aiPendingCount">23</span>
            </a>
            
            <!-- 커뮤니티 모니터링 (신규) -->
            <a href="community-monitoring.html" class="nav-link --set-active-community-monitoring-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                <i class="fas fa-shield-alt mr-3 text-red-500"></i>
                <span>커뮤니티 모니터링</span>
                <span class="ml-auto" id="alertIndicator">
                    <i class="fas fa-circle text-green-400 text-xs" title="정상"></i>
                </span>
            </a>
        </div>
        
        <!-- 구분선 -->
        <div class="px-4 mt-6">
            <div class="border-t border-gray-200"></div>
        </div>
        
        <!-- 고급 기능 섹션 -->
        <div class="px-4 mt-6">
            <h3 class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">고급 기능</h3>
            <div class="mt-3 space-y-2">
                <!-- 광고 관리 (신규) -->
                <a href="ad-management.html" class="nav-link --set-active-ad-management-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-bullhorn mr-3 text-yellow-500"></i>
                    <span>광고 관리</span>
                    <span class="ml-auto px-2 py-1 text-xs bg-yellow-100 text-yellow-600 rounded-full">수익화</span>
                </a>
                
                <!-- 리포트 (유지하되 내용 변경) -->
                <a href="reports.html" class="nav-link --set-active-reports-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-chart-bar mr-3 text-teal-500"></i>
                    <span>분석 리포트</span>
                </a>
                
                <!-- API 관리 (신규) -->
                <a href="api-management.html" class="nav-link --set-active-api-management-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-code mr-3 text-indigo-400"></i>
                    <span>API 관리</span>
                    <span class="ml-auto" id="apiStatus">
                        <i class="fas fa-circle text-green-400 text-xs" title="API 정상"></i>
                    </span>
                </a>
            </div>
        </div>
        
        <!-- 구분선 -->
        <div class="px-4 mt-6">
            <div class="border-t border-gray-200"></div>
        </div>
        
        <!-- 시스템 섹션 -->
        <div class="px-4 mt-6">
            <h3 class="px-4 text-xs font-semibold text-gray-400 uppercase tracking-wider">시스템</h3>
            <div class="mt-3 space-y-2">
                <!-- 설정 (유지) -->
                <a href="settings.html" class="nav-link --set-active-settings-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-cog mr-3 text-gray-500"></i>
                    <span>설정</span>
                </a>
                
                <!-- 시스템 로그 (신규) -->
                <a href="system-logs.html" class="nav-link --set-active-system-logs-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-file-alt mr-3 text-gray-500"></i>
                    <span>시스템 로그</span>
                </a>
                
                <!-- 백업 관리 (신규) -->
                <a href="backup.html" class="nav-link --set-active-backup-html flex items-center px-4 py-2 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors">
                    <i class="fas fa-database mr-3 text-gray-500"></i>
                    <span>백업 관리</span>
                </a>
            </div>
        </div>
        
        <!-- 하단 메뉴 및 상태 -->
        <div class="absolute bottom-0 w-full p-4 border-t border-gray-200 bg-white">
            <!-- 시스템 상태 요약 -->
            <div class="mb-4 p-3 bg-gray-50 rounded-lg">
                <div class="flex items-center justify-between text-xs text-gray-600 mb-1">
                    <span>뉴스 수집</span>
                    <span class="text-green-600">정상</span>
                </div>
                <div class="flex items-center justify-between text-xs text-gray-600 mb-1">
                    <span>AI 요약</span>
                    <span class="text-green-600">작동중</span>
                </div>
                <div class="flex items-center justify-between text-xs text-gray-600">
                    <span>커뮤니티</span>
                    <span class="text-blue-600">활성</span>
                </div>
            </div>
            
            <!-- 사용자 정보 및 로그아웃 -->
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <img src="https://via.placeholder.com/24x24/4F46E5/FFFFFF?text=A" class="w-6 h-6 rounded-full mr-2">
                    <span class="text-sm text-gray-700">관리자</span>
                </div>
                <a href="login.html" class="text-gray-400 hover:text-gray-600 transition-colors" title="로그아웃">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            </div>
        </div>
    </nav>
</div>

<!-- 사이드바 관련 JavaScript -->
<script>
// 실시간 카운터 업데이트
function updateSidebarCounters() {
    // 뉴스 수집 카운터
    const newsCounter = document.getElementById('newsCollectedToday');
    if (newsCounter) {
        const current = parseInt(newsCounter.textContent.replace('+', ''));
        if (Math.random() > 0.7) { // 30% 확률로 업데이트
            newsCounter.textContent = `+${current + 1}`;
        }
    }
    
    // AI 처리 대기 카운터
    const aiCounter = document.getElementById('aiPendingCount');
    if (aiCounter) {
        const current = parseInt(aiCounter.textContent);
        const newCount = Math.max(0, current + (Math.random() > 0.5 ? -1 : 1));
        aiCounter.textContent = newCount.toString();
        
        // 카운터에 따른 색상 변경
        if (newCount > 50) {
            aiCounter.className = 'ml-auto px-2 py-1 text-xs bg-red-100 text-red-600 rounded-full';
        } else if (newCount > 20) {
            aiCounter.className = 'ml-auto px-2 py-1 text-xs bg-orange-100 text-orange-600 rounded-full';
        } else {
            aiCounter.className = 'ml-auto px-2 py-1 text-xs bg-green-100 text-green-600 rounded-full';
        }
    }
}

// 시스템 상태 표시등 업데이트
function updateStatusIndicators() {
    const alertIndicator = document.getElementById('alertIndicator');
    const apiStatus = document.getElementById('apiStatus');
    
    // 커뮤니티 모니터링 상태
    if (alertIndicator) {
        const hasAlert = Math.random() > 0.9; // 10% 확률로 경고
        if (hasAlert) {
            alertIndicator.innerHTML = '<i class="fas fa-circle text-red-400 text-xs animate-pulse" title="주의 필요"></i>';
        } else {
            alertIndicator.innerHTML = '<i class="fas fa-circle text-green-400 text-xs" title="정상"></i>';
        }
    }
    
    // API 상태
    if (apiStatus) {
        const apiDown = Math.random() > 0.95; // 5% 확률로 API 문제
        if (apiDown) {
            apiStatus.innerHTML = '<i class="fas fa-circle text-red-400 text-xs animate-pulse" title="API 오류"></i>';
        } else {
            apiStatus.innerHTML = '<i class="fas fa-circle text-green-400 text-xs" title="API 정상"></i>';
        }
    }
}

// 네비게이션 활성화 처리 개선
function initSidebarNavigation() {
    const navLinks = document.querySelectorAll('.nav-link');
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    
    navLinks.forEach(link => {
        link.classList.remove('active', 'bg-indigo-50', 'text-indigo-600', 'border-indigo-500');
        
        const href = link.getAttribute('href');
        if (href === currentPage) {
            link.classList.add('active', 'bg-indigo-50', 'text-indigo-600');
            link.style.borderLeft = '3px solid #4f46e5';
            
            // 아이콘 색상도 변경
            const icon = link.querySelector('i');
            if (icon) {
                icon.classList.add('text-indigo-600');
            }
        }
    });
}

// 사이드바 축소/확장 기능 (선택사항)
function initSidebarToggle() {
    let isCollapsed = false;
    
    // 더블클릭으로 사이드바 축소/확장
    document.getElementById('sidebar').addEventListener('dblclick', function() {
        isCollapsed = !isCollapsed;
        
        if (isCollapsed) {
            this.classList.add('w-16');
            this.classList.remove('w-64');
            
            // 텍스트 숨기기
            this.querySelectorAll('span').forEach(span => {
                if (!span.classList.contains('ml-auto')) {
                    span.style.display = 'none';
                }
            });
            
            // 로고 텍스트 숨기기
            this.querySelector('h1').innerHTML = '<i class="fas fa-flask"></i>';
        } else {
            this.classList.add('w-64');
            this.classList.remove('w-16');
            
            // 텍스트 보이기
            this.querySelectorAll('span').forEach(span => {
                span.style.display = 'inline';
            });
            
            // 로고 텍스트 복원
            this.querySelector('h1').innerHTML = '<i class="fas fa-flask mr-2"></i>FactLab Admin';
        }
    });
}

// 툴팁 기능 (축소 상태에서)
function initTooltips() {
    const navLinks = document.querySelectorAll('.nav-link');
    
    navLinks.forEach(link => {
        link.addEventListener('mouseenter', function() {
            const sidebar = document.getElementById('sidebar');
            if (sidebar.classList.contains('w-16')) {
                const text = this.querySelector('span').textContent;
                // 툴팁 표시 로직 (간단한 title 속성 사용)
                this.title = text;
            }
        });
    });
}

// 초기화
document.addEventListener('DOMContentLoaded', function() {
    initSidebarNavigation();
    initSidebarToggle();
    initTooltips();
    
    // 정기적 업데이트
    setInterval(updateSidebarCounters, 30000); // 30초마다
    setInterval(updateStatusIndicators, 60000); // 1분마다
    
    // 초기 업데이트
    updateSidebarCounters();
    updateStatusIndicators();
});

// 페이지 변경 감지 및 카운터 업데이트
window.addEventListener('focus', function() {
    updateSidebarCounters();
    updateStatusIndicators();
});
</script>